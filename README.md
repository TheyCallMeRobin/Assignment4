# CMPS415-Assignment4

**CMPS-415**

Node/Express/Mongo Assignment: **EXP-MONGO**

In this assignment we will expand on the in-class lab work in which we created a Mongo database and used Node/Express code to deal with form data, access a Mongo database, and use cookies. In this assignment we expand on it by creating Node/Express code to create an authentication system which collects user input to be used for adding new records to the database as well as to search the database and manage authentication cookies.

**Specifics:**

Study and run in Codespaces the repository https://github.com/ckselu/MongoTestPub which shows examples of code used to search existing entries as well as to insert new data in a Mongo database.

Also study the expres5.js file in the repository https://github.com/ckselu/testme which shows examples of using cookies.

Write Node/Express code which will do the following:

At the default endpoint (route), the code will check for the existence of an authentication cookie. Then,

- If an authentication cookie does not exist, the user is presented with a form to "login" or to "register".
  - The "register" form should ask for a desired user_ID and desired password. Then upon submission, these should be entered in a Mongo database.
  - The "login" form should ask for user_ID and password. Upon submission, the login keys should be looked up in the database to see if they exist as a pair (i.e. the pair is valid). If they are, an authentication cookie should be generated for the browser, which should be expiring in a minute or so. If the pair is not valid, a message should be generated along with a link to return to the default endpoint.
- If an authentication cookie exists, a message should be generated confirming that the cookie exists, and prints its value.
- All output views generated by the program must contain a link to an endpoint route which prints all the cookies which are active on that app **and** provides a link to an endpoint route that resets/clears the cookie.
- The cookie clearing endpoint should print a confirmation message along with a link to return the user to the default route.

**Your tasks:**

T1. (10 points). Use the Mongo database which we created in the class exercises. Create a new collection to use for this assignment. This is where you will store the login credentials. How different records are represented in the DB is up to you. For example you may store a userID and password as **crisk:'mypass'** key-value pairs, or as records of the sort: **{ userID:'crisk', userID:'mypass' }** or any other way it suits you. Make sure to create a new user to access the database (not your administrative access and certainly not your Google access keys or any other account keys) which to use for your program URI. You must provide these keys in your report so that your database can be checked for properly accepting credential insertions from the program.
T2. (20 points). For a registration, the registration credentials must be properly written in the database. Refreshing the collection view page of the Mongo database (on Atlas) should show the new record. You do not need to check for uniqueness but take care to not use duplicates in your testing.
T3. For a login, the credentials must be checked against the database (i.e. they either exist in the DB as provided or they do not).
T3.1. (10 points). Unsuccessful login leads to an appropriate message and a link back to the default endpoint.
T3.2. (30 points). Successful login generates an authentication cookie which expires shortly and an appropriate message.
T4. (10 points). Make sure that on all views (outputs to the browser), along with any other messages or output, there is also a link generated which leads to a cookie-reporting endpoint which is used for the sole purpose of printing all the active cookies of this app along with their values. It must also lead to a cookie-clearing endpoint route (see next).
T5. (10 points). Provide a route for clearing all cookies of the app. Its output must provide a link to the cookie-reporting endpoint (see above) as well as a link to the default route endpoint.
T6. (10 points). Write a report (and upload it on Canvas) in which you explain the following:
T6.1. Explain which of the above parts your code has successfully accomplished **and** also explain which it did not. That is, explain clearly which of the above functionality you implemented with your code or if there are any parts that you did not get to reach. Use a table provided at the end of this document to report this part.
T6.2. Include your code in text form as an appendix. It should be possible to use this for copying and pasting for independently testing the code. Include markers (as comments) which can be used as references to explain which parts of the code implement the various required functions (see below).
T6.3. Use separate sections in which to demonstrate the various tasks/parts of the assignment. For each task: - State whether the task was accomplished, or partially accomplished, or not accomplished. If partially accomplished, please explain how much was accomplished and what difficulties you did not manage to overcome. - Provide the reference marker(s) in your code (provided in the above appendix) which mark the part of the code which implements the task, i.e. show how the task is linked to your code in the appendix. - Demonstrate that the required functionality has been implemented by including the routes as links which can be tested, and include screenshots of output. - Please provide screenshots of output which show the parts that you did manage to work out. Obviously adequate screenshots confirming that the parts work properly are required, but you do not need to overdo screenshots; we only need to confirm the implementation of the various parts and they must be what testing should be able to recreate.
T6.4. Include any other pertinent comments as you wish in a concluding section as you consider necessary.

**Notes**:

- Consult the code examples which we did in class. You should be able to do almost all of the assignment by modifying and reassembling the functions presented in class.
- This is NOT a group project. While you may discuss methods or approach, it is against the assignment's integrity to share or exchange the code or to outsource it in any way.
- You should test your code on Codespaces but eventually you must build it on Render.com. Suspend your render apps until you are asked to revive them for testing.
- Make your Github repositories PRIVATE and please only make them public when you are asked to do so for testing. After testing they should be turned back to private.
- If you wish to continue working on your code/app after submitting the assignment, please make new repositories and apps; do not alter the ones on which you have reported and need to be tested for grading.

**Grading:**

- You will earn 10 points for attempting the assignment and submitting a report even if the code does not work or it crashes. These are the 10 points for turning in a report (as noted for task 6 above). The report must show that the assignment was seriously attempted; no points will be earned for "reporting" that the assignment was not even attempted.
- You will earn points for a working implementation of each of the register, login, and cookie reporting/clearing operations. The points are broken down as shown in the various tasks above.
- Important note: Your report must convey accurately how many parts of the assignment you have accomplished; therefore there will be a 30 points penalty for each/any misrepresentation of tasks accomplished.

Please use the following table to include (copy/paste) in your report to help the reporting and grading process:

| **Task** | **Max<br>Points** | **Ö/P/X** | **Reference<br>code marker(s)** | **Section #<br>of screenshots** | **Testing links** |
| :------: | :---------------: | :-------: | :-----------------------------: | :-----------------------------: | :---------------: |
|  **T1**  |      **10**       |           |                                 |                                 |                   |
|  **T2**  |      **20**       |           |                                 |                                 |                   |
| **T3.1** |      **10**       |           |                                 |                                 |                   |
| **T3.2** |      **30**       |           |                                 |                                 |                   |
|  **T4**  |      **10**       |           |                                 |                                 |                   |
|  **T5**  |      **10**       |           |                                 |                                 |                   |
|  **T6**  |      **10**       |           |                                 |                                 |                   |

Explanations for the table use:

- Place a mark in the column "**Ö/P/X**" to indicate that the corresponding task was fully accomplished (**Ö**) or partially accomplished (**P**) or not accomplished (**X**). If partially accomplished make sure to explain this in the corresponding section for that task (see T6.3 above).
- Provide "**Reference code marker(s)**" which link the task with the part of your code which implements this part. For example: //T3.1-REF1, //T3.1-REF2 may be markers in your code which mark two sections of code which implement task T3.1. These should be marking your code as comments, and should be inserted in this column to provide the link between the task and the code.
- Provide in "**Section# of screenshots**" the identifier (or number) of the section or appendix in which the implementation of the corresponding task is demonstrated.
- Please include in "**Testing links**" the testing links/endpoints which should be used for testing your app. These may be duplicates of URLs included in the various sections demonstrating the various tasks, but here please only include the ones necessary for testing (in case you have included various multiple example links or more detailed ones in the task reporting sections).
